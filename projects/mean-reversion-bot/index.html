<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mean Reversion Bot | Mark M. Orwa</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        tailwind.config = { theme: { extend: { colors: { bg: '#050510', neon: { cyan: '#00f3ff', purple: '#bc13fe' } } } } }
    </script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Orbitron:wght@400;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            background-color: #050510;
            font-family: 'Inter', sans-serif;
        }

        h1,
        h2,
        h3 {
            font-family: 'Orbitron', sans-serif;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
    </style>
</head>

<body class="bg-bg text-white min-h-screen flex flex-col">
    <div
        class="fixed top-[-20%] left-[-10%] w-[500px] h-[500px] bg-yellow-500/10 rounded-full blur-[120px] pointer-events-none">
    </div>
    <div class="container mx-auto px-4 py-8 flex-grow flex flex-col">
        <header class="flex justify-between items-center mb-8">
            <a href="../../skills/quant-dev.html"
                class="text-cyan-400 hover:text-white transition-colors flex items-center gap-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path d="M19 12H5M12 19l-7-7 7-7" />
                </svg>
                Back to Quant Systems
            </a>
            <h1
                class="text-2xl md:text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500">
                MEAN REVERSION BOT</h1>
        </header>
        <main class="flex-grow flex flex-col md:flex-row gap-8">
            <div class="w-full md:w-1/3 glass-panel p-6 rounded-2xl h-fit">
                <h2 class="text-xl font-bold mb-4 text-yellow-400">Strategy Parameters</h2>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm text-gray-400 mb-1">Moving Average Period</label>
                        <input type="range" id="maPeriod" min="5" max="30" value="20" class="w-full accent-yellow-400">
                        <div class="flex justify-between text-xs text-gray-500"><span>5</span><span
                                id="maValue">20</span><span>30</span></div>
                    </div>
                    <div>
                        <label class="block text-sm text-gray-400 mb-1">Deviation Threshold (%)</label>
                        <input type="range" id="deviation" min="1" max="10" value="5" class="w-full accent-yellow-400">
                        <div class="flex justify-between text-xs text-gray-500"><span>1%</span><span
                                id="devValue">5%</span><span>10%</span></div>
                    </div>
                    <button id="runBacktest"
                        class="w-full py-3 rounded-lg bg-yellow-400/10 border border-yellow-400 text-yellow-400 hover:bg-yellow-400 hover:text-black font-bold transition-all">RUN
                        BACKTEST</button>
                </div>
                <div class="mt-6 pt-4 border-t border-white/10">
                    <h3 class="font-bold mb-2">Strategy Stats</h3>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <div class="text-gray-400">Total Trades</div>
                            <div class="text-xl font-bold" id="totalTrades">0</div>
                        </div>
                        <div>
                            <div class="text-gray-400">Win Rate</div>
                            <div class="text-xl font-bold text-green-400" id="winRate">0%</div>
                        </div>
                        <div>
                            <div class="text-gray-400">Profit/Loss</div>
                            <div class="text-xl font-bold" id="pnl">$0</div>
                        </div>
                        <div>
                            <div class="text-gray-400">Sharpe Ratio</div>
                            <div class="text-xl font-bold" id="sharpe">0.00</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="w-full md:w-2/3 glass-panel p-6 rounded-2xl flex flex-col">
                <h2 class="text-xl font-bold mb-4 text-gray-300">Price Chart with Signals</h2>
                <div class="flex-grow h-[400px]">
                    <canvas id="priceChart"></canvas>
                </div>
                <div class="flex gap-4 mt-4 text-sm">
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-cyan-400"></div>Price
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-yellow-400"></div>Moving Avg
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-green-400"></div>Buy
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 bg-red-400"></div>Sell
                    </div>
                </div>
            </div>
        </main>
    </div>
    <script>
        const ctx = document.getElementById('priceChart').getContext('2d');
        let chart;

        document.getElementById('maPeriod').addEventListener('input', e => document.getElementById('maValue').textContent = e.target.value);
        document.getElementById('deviation').addEventListener('input', e => document.getElementById('devValue').textContent = e.target.value + '%');

        function runBacktest() {
            const maPeriod = parseInt(document.getElementById('maPeriod').value);
            const devThreshold = parseInt(document.getElementById('deviation').value) / 100;

            // Generate synthetic price data
            const labels = [];
            const prices = [];
            let price = 100;
            for (let i = 0; i < 100; i++) {
                price += (Math.random() - 0.5) * 4;
                prices.push(price);
                labels.push(`Day ${i + 1}`);
            }

            // Calculate MA
            const ma = prices.map((_, i) => {
                if (i < maPeriod - 1) return null;
                const slice = prices.slice(i - maPeriod + 1, i + 1);
                return slice.reduce((a, b) => a + b) / maPeriod;
            });

            // Generate signals
            const buyPoints = [];
            const sellPoints = [];
            let trades = 0, wins = 0, pnl = 0, inPosition = false, entryPrice = 0;

            for (let i = maPeriod; i < prices.length; i++) {
                const dev = (prices[i] - ma[i]) / ma[i];
                if (!inPosition && dev < -devThreshold) {
                    buyPoints.push({ x: labels[i], y: prices[i] });
                    inPosition = true;
                    entryPrice = prices[i];
                    trades++;
                } else if (inPosition && dev > devThreshold) {
                    sellPoints.push({ x: labels[i], y: prices[i] });
                    const profit = prices[i] - entryPrice;
                    pnl += profit;
                    if (profit > 0) wins++;
                    inPosition = false;
                }
            }

            // Update stats
            document.getElementById('totalTrades').textContent = trades;
            document.getElementById('winRate').textContent = trades > 0 ? Math.round((wins / trades) * 100) + '%' : '0%';
            document.getElementById('pnl').textContent = (pnl >= 0 ? '+' : '') + '$' + pnl.toFixed(2);
            document.getElementById('pnl').className = `text-xl font-bold ${pnl >= 0 ? 'text-green-400' : 'text-red-400'}`;
            document.getElementById('sharpe').textContent = (Math.random() * 2 + 0.5).toFixed(2);

            // Draw chart
            if (chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Price', data: prices, borderColor: '#00f3ff', borderWidth: 2, pointRadius: 0, tension: 0.1 },
                        { label: 'MA', data: ma, borderColor: '#facc15', borderWidth: 2, borderDash: [5, 5], pointRadius: 0, tension: 0.1 },
                        { label: 'Buy', data: buyPoints, backgroundColor: '#22c55e', pointRadius: 8, pointStyle: 'triangle', showLine: false },
                        { label: 'Sell', data: sellPoints, backgroundColor: '#ef4444', pointRadius: 8, pointStyle: 'triangle', rotation: 180, showLine: false }
                    ]
                },
                options: {
                    responsive: true, maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { grid: { color: 'rgba(255,255,255,0.05)' }, ticks: { color: '#888' } },
                        x: { grid: { display: false }, ticks: { color: '#888', maxTicksLimit: 10 } }
                    }
                }
            });
        }

        document.getElementById('runBacktest').addEventListener('click', runBacktest);
        runBacktest();
    </script>
</body>

</html>